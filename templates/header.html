<!-- Template para el Header (extraído de script.js) -->
<!-- Este template se utiliza en la función renderHeader() -->

<template id="header-template">
    <div class="header ${headerCollapsed ? 'collapsed' : ''}">
        ${!headerCollapsed ? `
            <div class="header-main">
                <div class="header-row-1">
                    <div class="header-left">
<svg class="train-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
    <rect x="4" y="6" width="16" height="12" rx="2"/>
    <path d="M4 11h16M12 6v5"/>
    <circle cx="9" cy="16" r="1"/>
    <circle cx="15" cy="16" r="1"/>
</svg>
<div class="header-title-group">
<button class="title train-selector-btn" onclick="toggleTrainSelector()">
    <span class="train-name">\${trainName}</span>
    <span class="train-occupancy-badge \${occupancyClass}">\${occupancyPercentage}%</span>
    <span class="train-selector-arrow">▼</span>
</button>
    <div id="train-selector" class="train-selector-dropdown hidden">
        \${trainSelectorOptions}
    </div>
</div>

\${trainNumberSection}
</div>

<div class="header-right">
\${filterClearButton}
\${trainNumberDisplay}
</div>
                </div>

                \${currentStopSection}

<div class="header-actions">
<button class="action-btn" onclick="openServiceNotes()" title="Notas del servicio">
    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
        <polyline points="14 2 14 8 20 8"/>
        <line x1="12" y1="18" x2="12" y2="12"/>
        <line x1="9" y1="15" x2="15" y2="15"/>
    </svg>
    \${notesBadge}
</button>

<button class="action-btn \${incidentsClass}"
        onclick="openIncidentsPanel()"
        title="Incidencias">
    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"/>
        <line x1="12" y1="9" x2="12" y2="13"/>
        <line x1="12" y1="17" x2="12.01" y2="17"/>
    </svg>
    \${incidentBadge}
</button>

<button class="action-btn" onclick="toggleDarkMode()" title="Modo nocturno">
    \${darkModeIcon}
</button>

<button class="action-btn rotation-btn \${rotationClass}"
        onclick="toggleSeatRotation()"
        title="Invertir disposición de asientos">
    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M12 2v20M19 9l-7 7-7-7" />
    </svg>
</button>
<button class="action-btn delete-btn" onclick="clearAllData()" title="Borrar todos los datos">
<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
    <polyline points="3 6 5 6 21 6"/>
    <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/>
    <line x1="10" y1="11" x2="10" y2="17"/>
    <line x1="14" y1="11" x2="14" y2="17"/>
</svg>
</button>
<button class="action-btn more-options-btn" onclick="toggleMoreOptions()" title="Más opciones">
    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <circle cx="12" cy="12" r="1"/>
        <circle cx="12" cy="5" r="1"/>
        <circle cx="12" cy="19" r="1"/>
    </svg>
</button>

\${moreOptionsMenu}
</div>
            </div>
        ` : ''}

        <div class="coach-selector-row">
            <button class="header-collapse-btn" onclick="toggleHeaderCollapse()" title="\${collapseTitle}">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    \${collapseIcon}
                </svg>
            </button>
            <div class="coach-selector">
             \${coachButtons}
            </div>
        </div>
    </div>
</template>

<!-- Sub-template: Train Number Section -->
<template id="train-number-section-template">
<div style="position: relative; display: flex; align-items: center; gap: 0.5rem;">

    <!-- Interruptor Copiado rápido -->
    <button class="copy-toggle-btn" onclick="toggleCopyMode()" title="Copiado rápido">
        <div class="copy-switch \${copyModeClass}">
            <div class="copy-switch-handle"></div>
        </div>
    </button>

    <!-- Botón Filtros -->
    <button class="filters-btn" onclick="toggleFiltersMenu()" title="Filtros">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <polygon points="22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"/>
        </svg>
    </button>
<!-- Botón Pantallas -->
<button class="screens-btn" onclick="openScreensModal()" title="Pantallas de estación">
<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
    <rect x="3" y="4" width="18" height="12" rx="2" />
    <rect x="7" y="18" width="10" height="2" rx="1" />
</svg>
</button>

    <div id="filters-menu" class="filters-dropdown hidden">
        <button class="filter-option" onclick="openStopFilter()">
            Por parada de bajada
        </button>
        <button class="filter-option" onclick="openRouteFilter()">
            Por tramo recorrido
        </button>
        <button class="filter-option" onclick="openSeatFilter()">
            Por asiento
        </button>
            <button class="filter-option" onclick="openLinksFilter()">
    Por Enlaces
</button>
<button class="filter-option" onclick="openCommentsFilter()">
    Por comentario
</button>
    </div>
</div>
</template>

<!-- Sub-template: Current Stop Section -->
<template id="current-stop-section-template">
<div class="current-stop-row">
    <div class="current-stop-selector">
        <label class="current-stop-label">Parada actual:</label>
        <input
            type="text"
            class="current-stop-input"
            placeholder="\${currentStopPlaceholder}"
            value="\${currentStopSearch}"
            oninput="updateCurrentStopSearch(this.value)"
            onfocus="this.select()"
        />
        \${currentStopDropdown}
    </div>
</div>
</template>

<!-- Sub-template: More Options Menu -->
<template id="more-options-menu-template">
<div id="more-options-menu" class="more-options-dropdown hidden">
<button class="more-option" onclick="toggleShareSubmenu(); event.stopPropagation();">
    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <circle cx="18" cy="5" r="3"/>
        <circle cx="6" cy="12" r="3"/>
        <circle cx="18" cy="19" r="3"/>
        <line x1="8.59" y1="13.51" x2="15.42" y2="17.49"/>
        <line x1="15.41" y1="6.51" x2="8.59" y2="10.49"/>
    </svg>
    Compartir turno
    <span class="submenu-arrow">›</span>
</button>

<div id="share-submenu" class="submenu hidden">
    <button class="more-option submenu-item" onclick="generateQRCode(); toggleMoreOptions();">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <rect x="3" y="3" width="7" height="7"/>
            <rect x="14" y="3" width="7" height="7"/>
            <rect x="3" y="14" width="7" height="7"/>
            <rect x="14" y="14" width="7" height="7"/>
        </svg>
        Por código QR
    </button>
    <button class="more-option submenu-item" onclick="exportTurn(); toggleMoreOptions();">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
            <polyline points="7 10 12 15 17 10"/>
            <line x1="12" y1="15" x2="12" y2="3"/>
        </svg>
        Por archivo JSON
    </button>
</div>

<button class="more-option" onclick="toggleImportSubmenu(); event.stopPropagation();">
    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
        <polyline points="17 8 12 3 7 8"/>
        <line x1="12" y1="3" x2="12" y2="15"/>
    </svg>
    Importar turno
    <span class="submenu-arrow">›</span>
</button>

<div id="import-submenu" class="submenu hidden">
    <button class="more-option submenu-item" onclick="scanQRCode(); toggleMoreOptions();">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <rect x="3" y="3" width="7" height="7"/>
            <rect x="14" y="3" width="7" height="7"/>
            <rect x="3" y="14" width="7" height="7"/>
            <rect x="14" y="14" width="7" height="7"/>
        </svg>
        Escanear QR
    </button>
    <button class="more-option submenu-item" onclick="importTurn(); toggleMoreOptions();">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"/>
            <polyline points="13 2 13 9 20 9"/>
        </svg>
        Desde archivo JSON
    </button>
</div>

<button class="more-option" onclick="openBackupsPanel(); toggleMoreOptions();">
    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M3 12h18M3 6h18M3 18h18"/>
        <circle cx="7" cy="12" r="2"/>
    </svg>
    Backups automáticos
</button>
<button class="more-option" onclick="openManualTecnico(); toggleMoreOptions();">
    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"/>
        <path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"/>
    </svg>
    Manual Técnico de Trenes
</button>
<button class="more-option" onclick="openAbout(); toggleMoreOptions();">
    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <circle cx="12" cy="12" r="10"/>
        <line x1="12" y1="16" x2="12" y2="12"/>
        <line x1="12" y1="8" x2="12" y2="8"/>
    </svg>
    Acerca de
</button>

<button class="more-option" onclick="openReadmeModal(); toggleMoreOptions();">
    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <circle cx="12" cy="12" r="10"/>
        <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"/>
        <line x1="12" y1="17" x2="12.01" y2="17"/>
    </svg>
    Guía de uso
</button>
</div>
</template>
